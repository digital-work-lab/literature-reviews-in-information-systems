---
title: "Statistics"
format:
  html:
    toc: true
    toc-depth: 2
execute:
  echo: true
  warning: false
  message: false
---

```{r}
#| label: setup
#| include: false
library(dplyr)
library(ggplot2)
library(readr)
library(plotly)
library(DT)

# Load your dataset
# Replace with your actual file
df <- readr::read_csv("records.csv", show_col_types = FALSE)
```

## Timeline

```{r}
#| label: pubs_over_time
#| fig-cap: "Number of papers over time"

df_time <- df %>%
  dplyr::count(year) %>%
  dplyr::arrange(year)

plot_ly(
  data = df_time,
  x = ~year,
  y = ~n,
  type = "scatter",
  mode = "lines+markers"
) %>%
  layout(
    xaxis = list(title = "Year"),
    yaxis = list(title = "Number of Publications")
  )
```

## Journals

```{r}
#| label: journal_freq
#| tbl-cap: "Frequency of journals"

df %>%
  dplyr::count(journal, sort = TRUE) %>%
  DT::datatable(
    options = list(pageLength = 10),
    rownames = FALSE
  )
```

## Review types

```{r}
#| label: lr_type_pare_et_al
#| fig-cap: "Distribution of literature review types (Par√© et al.)"

df_lr_type <- df %>%
  dplyr::count(lr_type_pare_et_al, sort = TRUE)

plot_ly(
  data = df_lr_type,
  x = ~lr_type_pare_et_al,
  y = ~n,
  type = "bar"
) %>%
  layout(
    xaxis = list(title = "Literature review type"),
    yaxis = list(title = "Count")
  )
```

## Top cited

```{r}
#| label: top_cited
#| tbl-cap: "Top papers by Crossref citation count"

df %>%
  # keep only those with a citation count
  dplyr::filter(!is.na(cited_by)) %>%
  # ensure numeric in case it's stored as character
  dplyr::mutate(cited_by = as.numeric(cited_by)) %>%
  dplyr::arrange(dplyr::desc(cited_by)) %>%
  dplyr::slice_head(n = 30) %>%        # change n for more/less papers
  dplyr::select(
    cited_by,
    year,
    author,
    title,
    journal,
    doi
  ) %>%
  DT::datatable(
    options = list(pageLength = 10),
    rownames = FALSE
  )
```
